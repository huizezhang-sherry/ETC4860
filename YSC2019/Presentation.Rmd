---
title: "Exploration of Judicial Facial Expression in Videos of Legal Proceedings"
author: 
- "Huize Zhang"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: ["presdefault.css"]
    lib_dir: libs
    nature:
      ratio: '4:3'
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
editor_options: 
  chunk_output_type: console
---


[![A video for fun](../images/video_photo.png)](https://www.youtube.com/watch?v=Ae7uKzin0GA)

### Are the justices facial expression revealing the outcome of the case?

---
# Recent legal studies on judicial behaviour

- Tutton et al. (2018): 

  - studied judicial demenaur
  
  - Facial expressions were recorded manually  
  
  - This observational approach 
  
  - subjective when different people are observing the same videos

This motivates me to study the facial expression of the judge via an more objective approach by using facial recognition technology. 


---
# Face Recognition


- **Paul Ekman**: Facial Action Coding System (FACS)


- **Action units**: fundamental units of human facial muscles. 


.pull-left[

AU02 -	Outer eyebrow raiser

```{r echo = FALSE, message = FALSE, warning = FALSE}
library(knitr)
library(ggplot2)
library(emmeans)
library(tidyverse)
load("../raw_data/au_tidy.rda")
load("../raw_data/au_meaning.rda")
include_graphics("../images/AU2-right-only.gif")
```
]


.pull-right[

AU15 - Lip corner depressor

```{r echo = FALSE}
include_graphics("../images/AU15.gif")
```
]

 - widely used in facial recognition software development and human emotion reseraches

---

class: inverse, center, middle

# Data Collection

---

## Video Processing

```{r echo = FALSE, fig.align="center", fig_height = 3.8, fig_width = 6.3}
include_graphics("../images/workflow.png", dpi = 128)
```

### 4601 faces and 711 facial variables!

---
class: middle, center


```{r echo = FALSE, warning=  FALSE}
include_graphics("../images/long.png")

```

---
class: inverse, center, middle

#  Results


---

### Notation: 

- $X_1$ indicates `judge` with six categories $i = 1,2, \cdots, 6$
- $X_2$ indicates `video` for each of the seven cases, $j = 1,2, \cdots, 7$
- $X_3$ indicates action unit containing `r length(unique(au_tidy$AU))` possible facial expression.  
- $X_4$ indicates `speaker`, either the appellant or respondent, $l=1,2$
- $X_5$ indicates `frame` corresponding to time, $t = 1,2, \cdots, T_j$

Main effects model: 

$$Y_{ijkl} = \mu + \alpha_i + \beta_j + \gamma_k + \delta_l + \varepsilon_{ijkl}$$ 

---
## Mean Presence 

```{r echo = FALSE, message = FALSE, warning = FALSE}
most_common <- au_tidy %>% 
  group_by(judge,AU) %>% 
  summarise(avg_presence = mean(presence)) %>% 
  filter(avg_presence != "NaN") %>% 
  group_by(judge) %>% 
  arrange(-avg_presence) %>% 
  mutate(common = row_number()) %>% 
  mutate(most_common = as_factor(ifelse(common <=5, 1, 0))) %>% 
  left_join(au_meaning, by = c("AU" = "AU_number")) %>% 
  mutate(AU = as.factor(AU))

most_common %>% 
  ggplot(aes(x =  fct_reorder(AU, avg_presence), y = avg_presence,
             fill = most_common, col = most_common)) + 
  geom_col() +
  xlab("AU") + 
  ylab("Average Presence") + 
  facet_wrap(vars(judge)) + 
  coord_flip() + 
  theme(legend.position = "none")
```

---

## Modelling

\begin{equation}
P_{ik} = \mu + \alpha_i + \gamma_k + (\alpha\gamma)_{ik}
\end{equation}

```{r echo = FALSE, message = FALSE, warning = FALSE}
model_dt <- au_tidy %>% 
  ungroup(judge) %>% 
  mutate(judge = fct_relevel(judge, "Edelman"), 
         AU = fct_relevel(AU, "AU01")) 

model_dt_1 <- model_dt %>% 
  filter(AU %in% c("AU02", "AU20", "AU15","AU14"))

binomial_model_1 <- glm(presence ~ judge*AU, 
                        family = binomial(link = "logit"),  
                        data = model_dt_1)
lsmean_obj_1 <-  emmeans(binomial_model_1, ~judge*AU, type = "response")

lsmean_obj_1 %>% 
  as.data.frame() %>% 
  left_join(au_meaning, by = c("AU" = "AU_number")) %>% 
  as.data.frame()%>%   
  filter(!is.na(df)) %>% 
  ggplot(aes(x= judge, y = prob)) + 
  geom_point() + 
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2) + 
  facet_wrap(vars(AU_meaning))  + 
  coord_flip()
```


---
class: center, middle

# Acknowledgement

I would like to express my gratitude to Di Cook, Russell Symth and Stephanie Kobakian for helping me throughout the project.

Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan).


